(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{9208:function(e,a,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return n(2084)}])},2084:function(e,a,n){"use strict";n.r(a),n.d(a,{default:function(){return index_page}});var s=n(5893),t=n(8583),i=n(7294),l=n(3935);let Portal=e=>{let{children:a}=e,[n,s]=(0,i.useState)();return(0,i.useEffect)(()=>{let e=document.createElement("div");return document.body.appendChild(e),s(e),()=>{document.body.removeChild(e)}},[]),n?l.createPortal(a,n):null};var r=n(8046),c=n.n(r);let Loading=e=>e.visible?(0,s.jsx)(Portal,{children:(0,s.jsx)("div",{className:c().container,children:(0,s.jsx)("div",{className:c().loader})})}):null;var d=n(9258),o=n(8139),u=n(9399),_=n.n(u);let ModalBody=e=>(0,s.jsx)("div",{className:_().body,children:e.children}),Modal=e=>(0,s.jsx)(Portal,{children:e.open&&(0,s.jsxs)("div",{className:_().container,children:[(0,s.jsx)("div",{className:_().background,onClick:e.onClose}),(0,s.jsx)("div",{className:_().card,children:e.children})]})});var h=n(5379),x=n(5293),p=n.n(x);let BasicHeader=e=>{let[a,n]=(0,i.useState)(!1),onLogout=async()=>{n(!1),confirm("Logout?")&&await h.O.auth.signOut()};return(0,s.jsxs)("div",{className:p().container,children:[(0,s.jsxs)("div",{className:p().main,children:[(0,s.jsx)("div",{className:p().title,children:"deus-template"}),null===e.user?(0,s.jsx)("div",{onClick:()=>n(!0),children:(0,s.jsx)("div",{className:p().loginBtn,children:(0,s.jsx)("span",{children:"Login with Email"})})}):(0,s.jsx)("div",{className:p().userBtn,onClick:onLogout,children:(0,s.jsx)("span",{className:p().userName,children:e.user.name})})]}),(0,s.jsx)(Modal,{open:null===e.user&&a,onClose:()=>n(!1),children:(0,s.jsx)(ModalBody,{children:(0,s.jsx)(d.gx,{supabaseClient:h.O,providers:[],appearance:{theme:o.rD},redirectTo:location.origin})})})]})};var m=n(3483),j=n(6819),g=n(6221),v=n(8535),f=n.n(v),index_page=()=>{let[e]=(0,t.KO)(g.L),a=(0,i.useRef)(null),[n,l]=(0,i.useState)(),[r,c]=(0,i.useState)(""),[d,o]=(0,i.useState)(),fetchTasks=async()=>{let e=await m.x.public.tasks.$get().catch(j.F);null!==e&&l(e)},createTask=async e=>{e.preventDefault(),r&&a.current&&(await m.x.private.tasks.post({body:{label:r,image:d}}).catch(j.F),c(""),o(void 0),a.current.value="",await fetchTasks())},toggleDone=async e=>{await m.x.private.tasks.patch({body:{taskId:e.id,done:!e.done}}).catch(j.F),await fetchTasks()},deleteTask=async e=>{await m.x.private.tasks.delete({body:{taskId:e.id}}).catch(j.F),await fetchTasks()};return((0,i.useEffect)(()=>{fetchTasks()},[null==e?void 0:e.id]),n)?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(BasicHeader,{user:e}),(0,s.jsx)("div",{className:f().container,children:null===e?(0,s.jsx)("ul",{className:f().tasks,children:n.map(e=>(0,s.jsx)("li",{children:(0,s.jsxs)("label",{children:[(0,s.jsx)("span",{children:e.label}),e.image&&(0,s.jsx)("img",{src:e.image.url,width:"100%"})]})},e.id))}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("form",{style:{textAlign:"center"},onSubmit:createTask,children:[(0,s.jsx)("input",{value:r,type:"text",onChange:e=>{c(e.target.value)}}),(0,s.jsx)("input",{type:"submit",value:"ADD"}),(0,s.jsx)("div",{children:(0,s.jsx)("input",{type:"file",ref:a,accept:".png,.jpg,.jpeg,.gif,.webp,.svg",onChange:e=>{var a;o(null===(a=e.target.files)||void 0===a?void 0:a[0])}})})]}),(0,s.jsx)("ul",{className:f().tasks,children:n.map(e=>(0,s.jsxs)("li",{children:[(0,s.jsxs)("label",{children:[(0,s.jsx)("input",{type:"checkbox",checked:e.done,onChange:()=>toggleDone(e)}),(0,s.jsx)("span",{children:e.label})]}),e.image&&(0,s.jsx)("img",{src:e.image.url,width:"100%"}),(0,s.jsx)("input",{type:"button",value:"DELETE",className:f().deleteBtn,onClick:()=>deleteTask(e)})]},e.id))})]})})]}):(0,s.jsx)(Loading,{visible:!0})}},8046:function(e){e.exports={container:"Loading_container__wV1ri",loader:"Loading_loader__cpdbt",load:"Loading_load__8NQtO"}},9399:function(e){e.exports={container:"Modal_container__jKKR0",background:"Modal_background__4SbAJ",card:"Modal_card__ZLmjL",header:"Modal_header__Pfr2K",body:"Modal_body__KZX7m"}},5293:function(e){e.exports={container:"BasicHeader_container__ASIaK",main:"BasicHeader_main__Vqufr",title:"BasicHeader_title__YIFTt",userBtn:"BasicHeader_userBtn__wlK48",userIcon:"BasicHeader_userIcon__UecGa",userName:"BasicHeader_userName__KiR1h",loginBtn:"BasicHeader_loginBtn__Zy9wD"}},8535:function(e){e.exports={container:"index_container___q52_",tasks:"index_tasks__ExTXY",deleteBtn:"index_deleteBtn__wZo2L"}}},function(e){e.O(0,[774,888,179],function(){return e(e.s=9208)}),_N_E=e.O()}]);